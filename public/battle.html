<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="https://cdn.jsdelivr.net/npm/phaser@3.15.1/dist/phaser-arcade-physics.min.js"></script>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    <link rel="stylesheet" href="./assets/css/style.css"> 
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-light bg-dark">
        <div class="container">
          <a class="navbar-brand text-white" id="title-link">First Fantasy</a>
          <span class="navbar-text">
            <a class=".text-white" id="loginNav">Login</a>
          </span>
        </div>
      </nav>

      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
      <script src="./assets/js/index.js"></script>
      <script src="./assets/js/classes/character.js"></script>
      <script src="./assets/js/battle-logic.js"></script>
    <script>

    var config = {
        type: Phaser.AUTO,
        width: 950,
        height: 600,
        physics: {
            default: 'arcade',
            arcade: {
                gravity: { y: 200 }
            }
        },
        scene: {
            preload: preload,
            create: create,
            update: update
        }
    };

    var game = new Phaser.Game(config);

    function preload ()
    {
        this.load.path = 'assets/';

        this.load.image('background', 'game-art/bg/battleback1.png');
        this.load.image('druidroom', 'game-art/bg/druidroom.png');
        this.load.image('sorcererroom', 'game-art/bg/sorcererroom.png');
        this.load.image('skeletonroom', 'game-art/bg/skeletonroom.png');
        this.load.image('zombieroom', 'game-art/bg/zombieroom.png');
        this.load.image('onepunchroom', 'game-art/bg/onepunchroom.png');

        this.load.image('player1', 'game-art/sprites/player/knight.png');
        this.load.image('player2', 'game-art/sprites/player/mage.png');
        this.load.image('p1healthbar', 'game-art/userinterface/playerHealthbar.png');
        this.load.image('p2healthbar', 'game-art/userinterface/enemyHealthbar.png');

        this.load.image('druid', 'game-art/sprites/enemies/druid.png');
        this.load.image('sorcerer', 'game-art/sprites/enemies/death_speaker.png');
        this.load.image('skeleton', 'game-art/sprites/enemies/skeleton.png');
        this.load.image('zombie', 'game-art/sprites/enemies/zombie.png');
        this.load.image('onepunchman', 'game-art/sprites/enemies/onepunchman.png');
    }

    function create ()
    {
        
        window.player1 = new Player(this, 200, 300, 'player1', "Fionna", 85, 1, 65, 77);        
        this.add.existing(player1);

        window.enemy = new Player(this, 700, 300, 'druid', "Druid", 1, 1, 50, 70);     
        this.add.existing(enemy);
        enemy.setScale(0.6);

        var sorcerer = new Player(this, 700, 300, 'sorcerer', "Merlin", 40, 80, 40, 40);

        var hud = this.add.image(260, 515, 'hud');

        var atkBtn = this.add.text(50, 480, 'Attack');
        atkBtn.setScale(1.4);
        atkBtn.setInteractive();
        atkBtn.on('pointerout', () => priority())

        window.playerHP = player1.hp;
        window.enemyHP = enemy.hp;

        function druidroom ()
    {
        this.scene.start()
        this.cameras.main.flash(300);
        this.add.image(400, 300, 'druidroom');

        // var druid = new Player(this, 700, 300, 'druid', "Kjartan", 80, 40, 40, 40);
        this.add.existing(druid);

        enemyHP = druid.hp;

        if (enemyHP <= 0){
            sorcererroom()
        }
    }
        druidroom();

    function sorcererroom ()
    {   
        this.cameras.main.flash(300);
        this.add.image(400, 300, 'sorcererroom');

        //var sorcerer = new Player(this, 700, 300, 'sorcerer', "Merlin", 40, 80, 40, 40);
        //this.add.existing(sorcerer);

        enemy = sorcerer;

        enemyHP = sorcerer.hp;

        if (enemyHP <= 0) {
            console.log('SUCCESS!')
        }
    }

    function skeletonroom ()
    {
        this.cameras.main.flash(300);
        this.add.image(400, 300, 'skeletonroom');

        var skeleton = new Player(this, 700, 300, 'skeleton', "Dr. Bones", 40, 40, 80, 40);
        this.add.existing(skeleton);

        if (this.skeleton.enemyHP === 0) {
            this.scene.start('zombieroom')
        }
    }

    function zombieroom ()
    {
        this.cameras.main.flash(300);
        this.add.image(400, 300, 'zombieroom');

        var zombie = new Player(this, 700, 300, 'zombie', "Walking Fred", 40, 40, 40, 80);
        this.add.existing(zombie);

        if (this.zombie.enemyHP === 0) {
            this.scene.start('onepunchroom')
        }
    }

    function onepunchroom ()
    {
        this.cameras.main.flash(300);
        this.add.image(400, 300, 'onepunchroom');

        var onepunchman = new Player(this, 700, 300, 'onepunchman', "One Punch Man", 100000, 100000, 100000, 100000);
        this.add.existing(onepunchman);

        if (this.onepunchman.enemyHP === 0) {
            this.scene.stop('onepunchroom')
        }
    }

        

    }

    function update () 
    {
        var playerHpDisplay = this.add.text(280, 480, player1.name + "'s HP:" + playerHP);
        playerHpDisplay.setScale(1.4);
        var enemyHpDisplay = this.add.text(280, 500, enemy.name + "'s HP:" + enemyHP);
        enemyHpDisplay.setScale(1.4);
    }

    



    </script>

</body>
</html>